![](https://tcs.teambition.net/storage/31224ffc85c9867e2131d5fdae067df5daa1?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI0ZmZjODVjOTg2N2UyMTMxZDVmZGFlMDY3ZGY1ZGFhMSJ9.racQX__asvMQbUQPN4T1ypvTmOhlYkgl-hred9nA7rQ&download=image.png "")

![](https://tcs.teambition.net/storage/3122926d0385504dae5cb7de3e7e59608e35?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI5MjZkMDM4NTUwNGRhZTVjYjdkZTNlN2U1OTYwOGUzNSJ9.FDaFc_5D-IdRdlfwHjeaMZ0UPa2kO9MNW2zwY4pBkIM&download=image.png "")

![](https://tcs.teambition.net/storage/3122b47957a00112f576da71321a675fbc20?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJiNDc5NTdhMDAxMTJmNTc2ZGE3MTMyMWE2NzVmYmMyMCJ9.Oagw30Dp8ag4lM7ghonFK4lafOc783TiKD5vOu6dI08&download=image.png "")

![](https://tcs.teambition.net/storage/31229d8f4c393a2c9a840c458a72370b9fff?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI5ZDhmNGMzOTNhMmM5YTg0MGM0NThhNzIzNzBiOWZmZiJ9.bxXggY7KiFQbv5QUYRj2OWcry1kEKZgpIYptrOGXpr4&download=image.png "")

![](https://tcs.teambition.net/storage/312277ddb558128526cd53bcbd3c405433d4?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI3N2RkYjU1ODEyODUyNmNkNTNiY2JkM2M0MDU0MzNkNCJ9.YymBkWKArYhj6MeFRKaCiFtPXG4bAeIyrBDXBPOx3Kg&download=image.png "")

![](https://tcs.teambition.net/storage/312216828d82e5128857d6a54cb62b484e21?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIxNjgyOGQ4MmU1MTI4ODU3ZDZhNTRjYjYyYjQ4NGUyMSJ9.npoez1LXsqYSp0xH-OjVYuminbo-K9lPt3XrH4Gxnss&download=image.png "")

![](https://tcs.teambition.net/storage/312281325ff70742b5117454c56d0199035a?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzODc5MCwiaWF0IjoxNjEyNDMzOTkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI4MTMyNWZmNzA3NDJiNTExNzQ1NGM1NmQwMTk5MDM1YSJ9.5_fbGVS0SFWVKXO5aKTAG0U0tg62wZ5yNXo6Xq4cJoo&download=image.png "")

![](https://tcs.teambition.net/storage/3122cf95148a51ff59ee51163488f11f11ff?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJjZjk1MTQ4YTUxZmY1OWVlNTExNjM0ODhmMTFmMTFmZiJ9.VEds5y3kZFV6wpjPLZHA9aTdV4eiteh4hgW-TgPuw6o&download=image.png "")

![](https://tcs.teambition.net/storage/31222306c1df5753ac38a483365639ae8c6f?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIyMzA2YzFkZjU3NTNhYzM4YTQ4MzM2NTYzOWFlOGM2ZiJ9.RLAFZyhvOUPjbbtsPB4aVrMOnT7xo3FBpUG5AIMKJo4&download=image.png "")

![](https://tcs.teambition.net/storage/31223e36c262b92fb345592a7730b549bd37?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIzZTM2YzI2MmI5MmZiMzQ1NTkyYTc3MzBiNTQ5YmQzNyJ9.CwcJtTCCdn_A1wwuYS7loco6BQR0yskLbSox0KbufCI&download=image.png "")



K8S Master 有很多组件

API Server 组件





Pod 是多个容器的集合

Node是一个节点服务器



中间有很多耦合的模块





![](https://tcs.teambition.net/storage/3122e9ff4526c64416505d32b75ec291e25b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJlOWZmNDUyNmM2NDQxNjUwNWQzMmI3NWVjMjkxZTI1YiJ9.LJB7C5WECDUer6C81yJMZ8e-ojcfs2-wWwzJqQdp3yU&download=image.png "")

API Server

当我们K8S命令 发一条命令的时候 不管你是在Master跑 

还是在远端一台命令行终端上跑 

它的命令 都会通过网络或本机的形式发给我们的Master 

而Master API Server 会接收这个 命令 是否符合语法标准 

同时根据我们当前 实际的国内的集群环境 进行相应的处理



Scheduler

对所有资源 按照应用需求 进行统一调度 任务发布



![](https://tcs.teambition.net/storage/312285d389cfd59e5514ef262f87ab6aed14?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI4NWQzODljZmQ1OWU1NTE0ZWYyNjJmODdhYjZhZWQxNCJ9._Mwd5oNtjEQj0ev4LcE9m5ecv80ATRxEKy37z1OjkVg&download=image.png "")

CM 里面又分很多个具体的功能 整体组成了一台 资源统筹管理功能 

C 就是所有资源 所有任务的统一调度 部署 

管理所有资源 隔离不同的应用

同时也在一个应用里 做跨节点高可用的复制 统筹管理





Controller Manager 一大类 叫做 replication Controller 

这一类是负责 

负责我们容器 跨节点 怎么进行部署 怎么样实现它们之间的通信

同时怎么样进行标签（P）的管理 资源的选择等等



另外还有一个 namespace Controller

它是k8s 集群的一个虚拟化集群概念

会管理虚拟化集群所有资源隔离



![](https://tcs.teambition.net/storage/3122f7f7a65e20107d6a1cc39183e430f70f?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJmN2Y3YTY1ZTIwMTA3ZDZhMWNjMzkxODNlNDMwZjcwZiJ9.0n5wgiIS1li6t9FcY19xNyZ3quHXVc6EkqpF0AsO91E&download=image.png "")

支持模块 Etcd

类似Eureka server

集群配置管理 仲裁 选举

做集群配置统一的管理



k8s 的网络是跨很多个物理节点

有很多个容器之间互相沟通



推荐使用 Flannel Calico

另外一种它们组合方式 Canal



k8s Master 上 也可以当成手脚来用 

隐藏了所有的kubelet kube-proxy docker 以及 Container 所有功能 到 Master 物理字节 或者虚拟节点上 也就是里面包含了 node 节点

在我们资源分配的时候 不要分配的太小 虽然你不是在上面跑 实际的应用的容器 但是它有大量的监管容器 辅助容器 各种各样的网络容器都会在上面运行起来  所以要做合理的分配



Node 服务器节点



kubelet 核心功能模块

实现容器启动、停止、管理

怎么样给容器加网络资源

怎么把一个镜像变成一个容器 真正跑起来

跟 Docker 进行沟通的最核心的一个掌控这种容器管理模块

它是脑电波 或者说脑发出那些信令 信号所掌控的



Kube-proxy

容器和容器之间有很强的网络通信 

它的通信到底是以什么实际的方式来通信的呢

通过神经元互相之间感知 互相之间通信

这些神经元就是 kube-proxy

是一个类似于网络感知模块 或者说服务发现模块

类似服务发现 网络负载模块 

在k8s里面 我们用kube-proxy 来实现了 当容器不断的状态改变的时候 

会有一些自己内部配置转换 从而去跟其他容器 其他物理节点进行沟通 

使得容器的网络管理 服务发现 变成全自动



![](https://tcs.teambition.net/storage/312232fc483337413477051cf2d0a2b4f401?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzMjIzOSwiaWF0IjoxNjEyNDI3NDM5LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIzMmZjNDgzMzM3NDEzNDc3MDUxY2YyZDBhMmI0ZjQwMSJ9.7sfZtKgc4yPbWnRx87_bFCVp71lK2YroPmsHLa23U8E&download=image.png "")





![](https://tcs.teambition.net/storage/312277c01e433467415e1d2784ecedb6084f?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzMzg4MSwiaWF0IjoxNjEyNDI5MDgxLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI3N2MwMWU0MzM0Njc0MTVlMWQyNzg0ZWNlZGI2MDg0ZiJ9.D8Dlv-SHuCFMbDHCcIZpX5vPnll6adpoPIUtxwq_IvM&download=image.png "")

Pod 

两个以上的容器的集合

为什么要运行一堆的容器

不要孤立去管 某个很小很小的微服务 它实际具体情况

完全可以把一组共享网络 共享存储 所有服务 作为一个小 单元来统一进行管理

假设有一个消息节点

同时有一个消息 发送节点  一个消息接收节点

这样一套应用 可以把小的消息队列 消息发送和消息接收 做成一个pod

因为它通常是要 共享存储的 同时也要共享网络

完全可以把它封装在一个小应用

这个应用完全可以k8s 不同的这种控制器

实现多节点 高可用 可扩展的分布 发布

让这些所有容器在一个Pod 里面 共享IP地址 

它们有相同的ip地址 有相同网络的namespace（隔离资源）

它们所有的存储 NAS访问 磁盘映射 都是互通的

很方便的可以用网络 不同端口 用我们文件系统不同目录进行数据共享

每一个pod 一旦发布到node 节点上 哪这个node 只能在这个节点上

它的兄弟节点 另外一台node 上 另外一个pod 虽然跟它承载一样的内容

但他们有不同的pod名称 



![](https://tcs.teambition.net/storage/3122f3bc9cfd1d871dfb1b44fca106ce99b3?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNDc0MiwiaWF0IjoxNjEyNDI5OTQyLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJmM2JjOWNmZDFkODcxZGZiMWI0NGZjYTEwNmNlOTliMyJ9.R4uLsdkJZ2kcCOzfjrmp4S1_EljlNbo50zfzUc1xKIk&download=image.png "")

Controller

容器和容器之间是通过pod 一个个隔离



pod的管理抽象



是比pod 更高一级别的 统一管理抽象概念 



Deployment 就是我有一个应用 通常这个应用

就会产生一个部署的请求 而这样一个部署的请求 

这样一个应用 就是 会形成一堆的 pod

最常见的形成方法

Deployment是基于ReplicaSet上 



什么叫ReplicaSet？

就是 把一个pod 部署在节点1

把相同功能的 另外一个 pod 部署在节点2

在把一个类似的pod 部署在节点3

这样在多个节点上 部署更多个 pod 来完成相同功能

Deployment正是ReplicaSet上一级抽象





Daemon set

有些应用是在一个节点上只能跑一个

比如说我们跑一个Daemon 应用做磁盘签名 

 我不喜欢有两个这样的Daemon应用 跑在哪里 

很有可能会进行磁盘死锁 导致谁也清理不了

Daemon set 能保证我这个pod  在同一个节点上 只起一个



![](https://tcs.teambition.net/storage/3122616ec6ada9edd779e5e4ffb33feaed15?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTE5MiwiaWF0IjoxNjEyNDMwMzkyLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI2MTZlYzZhZGE5ZWRkNzc5ZTVlNGZmYjMzZmVhZWQxNSJ9.MHuhPkqJLH6vYVRnvBmkiEljucFnpqW5xiElvhDuIOM&download=image.png "")

StatefulSet

还有一些pod 希望我们对外 这个pod 名称 是  永远不变

它有一些特殊性 这个时候 可以用 StatefulSet 来进行pod的管理



job

还有一些pod 希望不是长期保持

我是一个 batch job

这个时候我希望 我的工作完成以后 我这个pod 就从 node上消失



我们看一下实际复制的

ReplicaSet 的实例

![](https://tcs.teambition.net/storage/31227f250e2e59ea3c1fd5c13d1f5171fd1a?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTMyOCwiaWF0IjoxNjEyNDMwNTI4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI3ZjI1MGUyZTU5ZWEzYzFmZDVjMTNkMWY1MTcxZmQxYSJ9.F4RZa5R3yfk9chNGNa6ir3k6DvGaMrygF458-mYghXg&download=image.png "")

![](https://tcs.teambition.net/storage/3122c91ef94a2a8f5b8f1d39d64834a677ff?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTM2NiwiaWF0IjoxNjEyNDMwNTY2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJjOTFlZjk0YTJhOGY1YjhmMWQzOWQ2NDgzNGE2NzdmZiJ9.A8M7fRNdf6fz4stPe0A4AM3k9B3Oj7ITrV2MDOzvSAw&download=image.png "")

![](https://tcs.teambition.net/storage/312282bc50a820d3892e9478dba77346918a?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTM3OCwiaWF0IjoxNjEyNDMwNTc4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI4MmJjNTBhODIwZDM4OTJlOTQ3OGRiYTc3MzQ2OTE4YSJ9.tE0V8E2sKAN5AXHuTp7p0nteH-c2yHNiNH2vnYbaQ3E&download=image.png "")



当一个 pod  出现问题  可能 replica set

会用 replication Controller尝试

![](https://tcs.teambition.net/storage/3122190a451fe559f1dd19fb849b3a88e5a6?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTQyOSwiaWF0IjoxNjEyNDMwNjI5LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIxOTBhNDUxZmU1NTlmMWRkMTlmYjg0OWIzYTg4ZTVhNiJ9.NQitob-BJzjPDCoYDgrNE7nwjBXzxMGciNjCbjKTymU&download=image.png "")

找到它 问题所在 然后 在相同的高可用情况下 在部署一个新的pod 



当一个node上的pod 死亡以后 我们根据规则 应该起3个 它会在node 那个高可用 在启一遍

这 就是replication Controller

它的实现机制 其实就是 replicaSet 

它的调度控制模块 就是前面说的 我们Controller Manage里面的replication Controller来进行统一管理



![](https://tcs.teambition.net/storage/312223ca87691624586e5591b6decf25e742?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTkyMSwiaWF0IjoxNjEyNDMxMTIxLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIyM2NhODc2OTE2MjQ1ODZlNTU5MWI2ZGVjZjI1ZTc0MiJ9.JGnjWB3e0PUtO0SY9d39xNrwWzRaopkV8_TYOD5qp2M&download=image.png "")

![](https://tcs.teambition.net/storage/3122b2c42358cb5cc9c01b0b870d21a6a88f?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTkzNiwiaWF0IjoxNjEyNDMxMTM2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJiMmM0MjM1OGNiNWNjOWMwMWIwYjg3MGQyMWE2YTg4ZiJ9.YNImEA6DjFufCf-14JZVSA_3KDWMoAj4i0j_lVKLox8&download=image.png "")

![](https://tcs.teambition.net/storage/3122952b62adf86e5d0b871ae6f75e7fe9fb?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTk1MywiaWF0IjoxNjEyNDMxMTUzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI5NTJiNjJhZGY4NmU1ZDBiODcxYWU2Zjc1ZTdmZTlmYiJ9.iQGB4_YZiQ-xTxBon5fFremWppkn4jL7z4AWGef1p7I&download=image.png "")

![](https://tcs.teambition.net/storage/3122a1526eb9d365081c0789b9b9ca8916da?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTk3MSwiaWF0IjoxNjEyNDMxMTcxLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJhMTUyNmViOWQzNjUwODFjMDc4OWI5YjljYTg5MTZkYSJ9.XFUfB0HcfYDCOTlshTmuXfdfc7wfsI8q37sPeQtbUUs&download=image.png "")

![](https://tcs.teambition.net/storage/3122a9aa09a84edfa7aa3e92a8715c127541?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTk4MywiaWF0IjoxNjEyNDMxMTgzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJhOWFhMDlhODRlZGZhN2FhM2U5MmE4NzE1YzEyNzU0MSJ9.hsyKwMwI7cb-0qNkwCEDwMTgZJ81KoGJVSu3OrnqeJo&download=image.png "")

![](https://tcs.teambition.net/storage/3122a695ac75f55441e4b66d5471ee1cc511?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTk5NiwiaWF0IjoxNjEyNDMxMTk2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJhNjk1YWM3NWY1NTQ0MWU0YjY2ZDU0NzFlZTFjYzUxMSJ9.nFkENrzz6ulkslctPoT010ACNBmTBeBCV_lUhGFbSYI&download=image.png "")







![](https://tcs.teambition.net/storage/3122e7d03f2a9cb1469c48476d8de47a79ac?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNjA5MCwiaWF0IjoxNjEyNDMxMjkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJlN2QwM2YyYTljYjE0NjljNDg0NzZkOGRlNDdhNzlhYyJ9.ziG1JvxdvKijVi3kJi4PYes7Bnjw9gNUM1zGJzrE9iE&download=image.png "")

![](https://tcs.teambition.net/storage/312236d3c361ce8babebabb5a7f14244e040?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNjEzMywiaWF0IjoxNjEyNDMxMzMzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIzNmQzYzM2MWNlOGJhYmViYWJiNWE3ZjE0MjQ0ZTA0MCJ9.woRxKu_uN9-WYhhUg6Vi9pOwwhRAYkciAeKzTCj4IAk&download=image.png "")

![](https://tcs.teambition.net/storage/3122ac771a82e647b18a37856bd509cc177c?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNjE1MCwiaWF0IjoxNjEyNDMxMzUwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJhYzc3MWE4MmU2NDdiMThhMzc4NTZiZDUwOWNjMTc3YyJ9.QT-oikdIUvClrgiCFNtFDhx4biTmeBsAn6_B7cGhe0Q&download=image.png "")

 

![](https://tcs.teambition.net/storage/312223ca87691624586e5591b6decf25e742?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNTkyMSwiaWF0IjoxNjEyNDMxMTIxLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIyM2NhODc2OTE2MjQ1ODZlNTU5MWI2ZGVjZjI1ZTc0MiJ9.JGnjWB3e0PUtO0SY9d39xNrwWzRaopkV8_TYOD5qp2M&download=image.png "")

![](https://tcs.teambition.net/storage/31225328ff8f1cf96b88da48a59ce5e303b6?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNjIxOSwiaWF0IjoxNjEyNDMxNDE5LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI1MzI4ZmY4ZjFjZjk2Yjg4ZGE0OGE1OWNlNWUzMDNiNiJ9.kO582j-etf9lyN_mraC_3uxnfG7JGVe6kSNur30_kWY&download=image.png "")

![](https://tcs.teambition.net/storage/3122cb07e5903a85f465dd085144f8828a7e?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNjIzMywiaWF0IjoxNjEyNDMxNDMzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJjYjA3ZTU5MDNhODVmNDY1ZGQwODUxNDRmODgyOGE3ZSJ9.--Qx8LapBzPvDj0IW-7eVRw0AwdicPcdWbCmoCXiTII&download=image.png "")

![](https://tcs.teambition.net/storage/3122b9ce18053b7406d70e5d279d0ea9a6c3?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNjI1MSwiaWF0IjoxNjEyNDMxNDUxLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJiOWNlMTgwNTNiNzQwNmQ3MGU1ZDI3OWQwZWE5YTZjMyJ9.2blb4haJXMLC9jeEPPsn0hMMmapM7MkUvnUfQidL2SE&download=image.png "")

![](https://tcs.teambition.net/storage/31220b3b45ae46007a5bc606f0cada6244f0?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzNjI3MCwiaWF0IjoxNjEyNDMxNDcwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIwYjNiNDVhZTQ2MDA3YTViYzYwNmYwY2FkYTYyNDRmMCJ9.eiNL6YvR0C_shsT0cnWUQfppLHGG8VzzoAQZdQ7aowQ&download=image.png "")



当我们一个应用 需要访问 其他应用的时候 会去产生找 DNS 服务器 找 完了以后 它知道ip地址



会通过kube-proxy 去访问这个pod  但是 如果这个 kube-proxy 当时拿到 地址是要访问另外一个pod 

KP 能知道所有pod 同一个 Deployment 里面的 pod  到底分布在在哪个不同的节点上 从而进行网络数据包的转发

这个整一套功能 结合 我们KP 结合我们DNS 来实现网络服务的功能 抽象出来叫 service

这个service 很好描述了我们应用 和应用之间的互相访问 

还配置了服务方式

整个一套用户访问机制才是service核心





Label 

对某些特殊的pod 打一些标签 这个标签打完了以后 就可用这些标签 查询这些pod 寻找



希望提供一个特殊的 ip地址 url

这个应用 后台 只给MyApp 这样名字应用 提供 这个网络 路由 



namespace

我们 平时所有的 Deployment 

pod

这些概念都是在一个虚拟集群上的

虽然我们物理上k8s  cluster



但是一个物理的cluster 默认就会 生成两个虚拟集群 







虚拟集群的概念叫namespace 

 

![](https://tcs.teambition.net/storage/3122026be4bfa6d4820e8297ddb3350473ae?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IjVmNTQ2ZDkyODI1NWU3ZjU1MzkxZmUwOSIsImV4cCI6MTYxMzAzODg0MCwiaWF0IjoxNjEyNDM0MDQwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIwMjZiZTRiZmE2ZDQ4MjBlODI5N2RkYjMzNTA0NzNhZSJ9.PHrlsPecbG22HY0NJZvJiOjYseAINsliRTIOPwO3fiA&download=image.png "")





































































































开源笔记

可 Pull Requests 协作写开源笔记

如果笔记图片无法访问 请访问 [teambition](https://tburl.in/0jDNvpbK) 原版开源笔记

gitee

[https://gitee.com/opendevel/java-for-linux](https://gitee.com/opendevel/java-for-linux)

github

[https://github.com/OSrcD/java-for-linux](https://github.com/OSrcD/java-for-linux)

teambition

[https://tburl.in/0jDNvpbK](https://tburl.in/0jDNvpbK)

开源视频

bilibili

[https://space.bilibili.com/77266754](https://space.bilibili.com/77266754)

开源博客

oschina

[https://my.oschina.net/u/4675154](https://my.oschina.net/u/4675154)

csdn

[https://blog.csdn.net/OpenDevel](https://blog.csdn.net/OpenDevel)

开源项目

gitee

[https://gitee.com/opendevel](https://gitee.com/opendevel)

github

[https://github.com/OSrcD](https://github.com/OSrcD)

开源赞赏

![](https://tcs.teambition.net/storage/3121aed56e96d914e1046f3b498b493ce232?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMzAzMTU1OCwiaWF0IjoxNjEyNDI2NzU4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFhZWQ1NmU5NmQ5MTRlMTA0NmYzYjQ5OGI0OTNjZTIzMiJ9.N5YSlMuzmtFHTOQoVHv-E_4aXbz7HxfwATC3VmgSpno&download=image.png "")

