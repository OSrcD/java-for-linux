![](https://tcs.teambition.net/storage/31216d64f56960a99b86df2b86ae4f5ef0ce?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NjAxMywiaWF0IjoxNjEyMTkxMjEzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE2ZDY0ZjU2OTYwYTk5Yjg2ZGYyYjg2YWU0ZjVlZjBjZSJ9.wkKK8nWDQcHKaBZIwj-1uNttMYWtY5QE-Bcejg8XZxA&download=2020-09-17%20052355.png "")

![](https://tcs.teambition.net/storage/312169b3bb8c828ab7d0bcad8229393d99dc?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NjAxMywiaWF0IjoxNjEyMTkxMjEzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE2OWIzYmI4YzgyOGFiN2QwYmNhZDgyMjkzOTNkOTlkYyJ9.pIP6IihAzrxFF5FS82FU17OjdYQSCdKb-zWp8PIXGUc&download=2020-09-17%20052440.png "")

![](https://tcs.teambition.net/storage/312196507d6273fb372a80203d88c2e5fa04?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NjAxMywiaWF0IjoxNjEyMTkxMjEzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE5NjUwN2Q2MjczZmIzNzJhODAyMDNkODhjMmU1ZmEwNCJ9.zWAaQXnzg3ZBAQtapxlQaNEvgaF6YPYGgD0K-urWakU&download=image.png "")

## IRule 是所有负载均衡策略的顶级类

## RoundRobinRule 默认的负载均衡策略



## RandomRule 随机的负载均衡策略

@Configuration是全局的

![](https://tcs.teambition.net/storage/31217fb5eaeaa3c68182a033f2f667301101?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NjAxMywiaWF0IjoxNjEyMTkxMjEzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE3ZmI1ZWFlYWEzYzY4MTgyYTAzM2YyZjY2NzMwMTEwMSJ9.JJfV0LNa4nU45ZQv4U4Df0gHy7-kJo-atGCKypHsrfA&download=image.png "")

## spring boot启动类有一个注解

![](https://tcs.teambition.net/storage/3121ece9f1620316042e040e9e79651065ec?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NjAxMywiaWF0IjoxNjEyMTkxMjEzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFlY2U5ZjE2MjAzMTYwNDJlMDQwZTllNzk2NTEwNjVlYyJ9.prJbJXKGSPqWX6S4vy_U7D2GhRR7K846Axx7VlOR4eA&download=image.png "")

eureka-client 服务的名称 

针对这一群启动的服务名称

![](https://tcs.teambition.net/storage/31215023710d6bc751c4e490c792aa54463c?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NjAxMywiaWF0IjoxNjEyMTkxMjEzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE1MDIzNzEwZDZiYzc1MWM0ZTQ5MGM3OTJhYTU0NDYzYyJ9.IVOJUq0RwostIkBRldUkN6D5qyykGGm41waBnXCWL18&download=image.png "")

```text
注解的方式配置负载均衡
@RibbonClient(name="指定服务名称",configuration = 指定负载均衡规则类)
```

![](https://tcs.teambition.net/storage/312164e8b8ec44944ed568879eada6910878?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NjAxMywiaWF0IjoxNjEyMTkxMjEzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE2NGU4YjhlYzQ0OTQ0ZWQ1Njg4NzllYWRhNjkxMDg3OCJ9.apnv-KjlnrWulj-ta05s4KQHuWBTTEFK65UDteV5_4Y&download=image.png "")

## 注解的优先级比配置文件优先级高

## 与项目加载的顺序有关

![](https://tcs.teambition.net/storage/31214416447e1abd56de1f7d6fdb0143441b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NjAxMywiaWF0IjoxNjEyMTkxMjEzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE0NDE2NDQ3ZTFhYmQ1NmRlMWY3ZDZmZGIwMTQzNDQxYiJ9.4wRIOl6mMPzqJRDjhc-GSM-RmLOV99hmlVDqsWefmdo&download=image.png "")

```java
package com.imooc.springcloud;

import com.netflix.loadbalancer.IRule;
import com.netflix.loadbalancer.RandomRule;
import org.springframework.cloud.netflix.ribbon.RibbonClient;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

// 全局配置
@Configuration
/**
 * @RibbonClient 基于注解方式配置负载均衡策略
 * name 指定微服务的名称 configuration 指定负载均衡策略
 */
@RibbonClient(name = "eureka-client", configuration = com.netflix.loadbalancer.RoundRobinRule.class)
public class RibbonConfiguration {

    /**
     * IRule 负载均衡策略顶级接口
     * RandomRule 随机负载均衡策略
     * 注解的优先级比配置文件优先级高
     */
    @Bean
    public IRule defaultLBStrategy() {
        return new RandomRule();
    }

}

```

![](https://tcs.teambition.net/storage/3121796bb67c3f0681db8aca0ecf8b5fe55c?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NjAxMywiaWF0IjoxNjEyMTkxMjEzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE3OTZiYjY3YzNmMDY4MWRiOGFjYTBlY2Y4YjVmZTU1YyJ9.THiBqB-AGxhmx1C_hg-PMIPGUB_DM9-XljdkV4OrnN0&download=image.png "")

```yaml
spring.application.name=ribbon-consumer

server.port=31000

eureka.client.serviceUrl.defaultZone=http://localhost:20000/eureka/

# 服务名称+固定格式 配置负载均衡策略为 RoundRobinRule 轮询模式
eureka-client.ribbon.NFLoadBalancerRuleClassName=com.netflix.loadbalancer.RoundRobinRule

```







开源笔记

可 Pull Requests 协作写开源笔记

gitee

[https://gitee.com/opendevel/java-for-linux](https://gitee.com/opendevel/java-for-linux)

github

[https://github.com/OSrcD/java-for-linux](https://github.com/OSrcD/java-for-linux)

teambition

[https://tburl.in/0jDNvpbK](https://tburl.in/0jDNvpbK)

开源视频

bilibili

[https://space.bilibili.com/77266754](https://space.bilibili.com/77266754)

开源博客

oschina

[https://my.oschina.net/u/4675154](https://my.oschina.net/u/4675154)

csdn

[https://blog.csdn.net/OpenDevel](https://blog.csdn.net/OpenDevel)

开源项目

gitee

[https://gitee.com/opendevel](https://gitee.com/opendevel)

github

[https://github.com/OSrcD](https://github.com/OSrcD)

开源赞赏

![](https://tcs.teambition.net/storage/3121aed56e96d914e1046f3b498b493ce232?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NjAxMywiaWF0IjoxNjEyMTkxMjEzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFhZWQ1NmU5NmQ5MTRlMTA0NmYzYjQ5OGI0OTNjZTIzMiJ9.1a3OIaUKh_UYQVzgdb2_dYW11bkpcbE7Q7DkdseHeQU&download=image.png "")

