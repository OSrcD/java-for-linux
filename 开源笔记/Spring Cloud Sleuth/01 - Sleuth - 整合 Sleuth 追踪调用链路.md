![](https://tcs.teambition.net/storage/3122e4d50b49c63fe31b3a21be4d6324cbba?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJlNGQ1MGI0OWM2M2ZlMzFiM2EyMWJlNGQ2MzI0Y2JiYSJ9.j2FKogLx5SSG4j_mlyaZohU2h8Col3LlBeePkDC5zkM&download=image.png "")

![](https://tcs.teambition.net/storage/31221ca67b37846687e8af814f92b4232ba6?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIxY2E2N2IzNzg0NjY4N2U4YWY4MTRmOTJiNDIzMmJhNiJ9.1P9xMXm8Enp6QSU9NrZfTJY7jMgy-RG2hFrHRRWSHlA&download=image.png "")

![](https://tcs.teambition.net/storage/312261b8a2fcad765e3fc9a76b8ba866c9e8?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI2MWI4YTJmY2FkNzY1ZTNmYzlhNzZiOGJhODY2YzllOCJ9.O3kva0R7wV4ThJp4ABlHPkcKk6J1okmfnhxqt1y9rHQ&download=image.png "")

![](https://tcs.teambition.net/storage/31221d8c8c13ff88b26d6aedbda9fea0444f?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIxZDhjOGMxM2ZmODhiMjZkNmFlZGJkYTlmZWEwNDQ0ZiJ9.8KR1KeUigwFRMtXoDe4KvtYf6wSJB80NEtlPWjcQzxw&download=image.png "")

![](https://tcs.teambition.net/storage/312269342f2cf10340cb05f82266fb41f5d1?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI2OTM0MmYyY2YxMDM0MGNiMDVmODIyNjZmYjQxZjVkMSJ9.CqfUFSWlziUDCIbuYIaGUv1HcZRJ6NsJCLbYqgDEm8I&download=image.png "")

![](https://tcs.teambition.net/storage/3122068cf8ed9949d251ae40e76f6aa4c21c?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIwNjhjZjhlZDk5NDlkMjUxYWU0MGU3NmY2YWE0YzIxYyJ9.Tko8yj-BtiHEn7ypfV-Mh-FV1beoH6JpsToK0hR0EgQ&download=image.png "")

![](https://tcs.teambition.net/storage/3122ebcc05571f192ca035be2007c23317d9?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJlYmNjMDU1NzFmMTkyY2EwMzViZTIwMDdjMjMzMTdkOSJ9.dbe4rCBXm8ejB-rKVWb04wfGw9_XKd5AzSqDPE8Yf_s&download=2020-09-17%20061040.png "")

![](https://tcs.teambition.net/storage/3122eca0af56aa126bc5c11719b116899b6b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJlY2EwYWY1NmFhMTI2YmM1YzExNzE5YjExNjg5OWI2YiJ9.4S12eu_pIrlCH0nigRJccSsOUgJQmBDe3XjxKP101N4&download=2020-09-17%20061125.png "")

![](https://tcs.teambition.net/storage/3122d03e27be50e8547a073dfbc54d10db6b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJkMDNlMjdiZTUwZTg1NDdhMDczZGZiYzU0ZDEwZGI2YiJ9.sUCtZwCKLLKQmhGQtyyOKmGIp0FTdPGRV_cOpHd8PrY&download=image.png "")

![](https://tcs.teambition.net/storage/3122cef18d2cca6912b1bcd6a6c846533bea?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJjZWYxOGQyY2NhNjkxMmIxYmNkNmE2Yzg0NjUzM2JlYSJ9.g3lOeGWyVYUVNzGr-hDcAujdbq4_S8IlIwYAnpyei7o&download=image.png "")

![](https://tcs.teambition.net/storage/31223f6e65ddc20861953ed067fc565a7eb5?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIzZjZlNjVkZGMyMDg2MTk1M2VkMDY3ZmM1NjVhN2ViNSJ9.BUuP88wYDkcxbku5oXXSc3Yo3Gp_HXld0QzIOQ2Piqk&download=image.png "")

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <parent>
        <artifactId>spring-cloud-demo</artifactId>
        <groupId>com.imooc</groupId>
        <version>1.0-SNAPSHOT</version>
        <relativePath>../../pom.xml</relativePath>
    </parent>
    <modelVersion>4.0.0</modelVersion>
    <packaging>jar</packaging>

    <artifactId>sleuth-traceA</artifactId>

    <dependencies>
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-sleuth</artifactId>
        </dependency>

    </dependencies>

</project>
```

![](https://tcs.teambition.net/storage/3122f053bfce1935713b55000fe3794b53ed?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJmMDUzYmZjZTE5MzU3MTNiNTUwMDBmZTM3OTRiNTNlZCJ9.3Ip2_olo6z4914bshx4-tSDS968oSHARxJiX1vtgfcM&download=image.png "")

```java
package com.imooc.springcloud;

import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.WebApplicationType;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;
import org.springframework.cloud.client.loadbalancer.LoadBalanced;
import org.springframework.context.annotation.Bean;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;


@EnableDiscoveryClient
@SpringBootApplication
@RestController
@Slf4j
public class SleuthTraceAMain {

    @LoadBalanced
    @Bean
    public RestTemplate lb() {
        return new RestTemplate();
    }

    @Autowired
    private RestTemplate restTemplate;


    @GetMapping(value = "/traceA")
    public String traceA() {
        log.info("-------Trace A");
        return restTemplate.getForEntity("http://sleuth-traceB/traceB", String.class)
                .getBody();
    }


    public static void main(String[] args) {
        new SpringApplicationBuilder(SleuthTraceAMain.class)
                .web(WebApplicationType.SERVLET)
                .run(args);
    }

}

```

![](https://tcs.teambition.net/storage/31222996e1861df1bb3d515df82e3bec9c9e?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIyOTk2ZTE4NjFkZjFiYjNkNTE1ZGY4MmUzYmVjOWM5ZSJ9.2R683m2jUGtNPt8lKnNfewYakKuMJCWf9E62Hjqw_KM&download=image.png "")

```none
spring.application.name=sleuth-traceA
server.port=62000

eureka.client.serviceUrl.defaultZone=http://localhost:20000/eureka/

logging.file=${spring.application.name}.log



info.app.name=sleuth-traceA
info.app.description=test

management.security.enabled.user.name=gitee
management.security.enabled.user.password=gitee
management.security.enabled.user.roles=ADMIN

management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always




```

![](https://tcs.teambition.net/storage/3122a70e1d1a821b3a71801550286ab4724b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJhNzBlMWQxYTgyMWIzYTcxODAxNTUwMjg2YWI0NzI0YiJ9.drORiNtlTbaQLdI5b-IJjZktFP0Mo8vyna8NIDGiVsc&download=image.png "")

```text
spring.application.name=sleuth-traceA
server.port=62000

eureka.client.serviceUrl.defaultZone=http://localhost:20000/eureka/

logging.file=${spring.application.name}.log

# 配置采样率 1 就是 100% 所有日志文件 收集出来
spring.sleuth.sampler.probability=1

info.app.name=sleuth-traceA
info.app.description=test

management.security.enabled.user.name=gitee
management.security.enabled.user.password=gitee
management.security.enabled.user.roles=ADMIN

management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always




```

![](https://tcs.teambition.net/storage/3122bd7cce9be43a41e164cbcea33f338891?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJiZDdjY2U5YmU0M2E0MWUxNjRjYmNlYTMzZjMzODg5MSJ9.5axGmFwpWQ7L-eiNOE3CWEmjr-ZmNV-5aTBp1ysMAQw&download=image.png "")

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!--该日志将日志级别不同的log信息保存到不同的文件中 -->
<configuration>
    <include resource="org/springframework/boot/logging/logback/defaults.xml" />

    <springProperty scope="context" name="springAppName"
                    source="spring.application.name" />

    <!-- 日志输出位置 -->
    <property name="LOG_FILE" value="${BUILD_FOLDER:-build}/${springAppName}" />

    <!-- 日志格式 -->
    <!-- %clr(${LOG_LEVEL_PATTERN:-%5p}) sleuth 的输出 -->
    <property name="CONSOLE_LOG_PATTERN"
              value="%clr(%d{HH:mm:ss.SSS}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}" />

    <!-- 控制台输出 -->
    <appender name="console" class="ch.qos.logback.core.ConsoleAppender">
        <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
            <level>INFO</level>
        </filter>
        <!-- 日志输出编码 -->
        <encoder>
            <pattern>${CONSOLE_LOG_PATTERN}</pattern>
            <charset>utf8</charset>
        </encoder>
    </appender>

    <!-- 日志输出级别 -->
    <root level="INFO">
        <appender-ref ref="console" />
    </root>

</configuration>

```

![](https://tcs.teambition.net/storage/31227944ae2048fb00f1619dc83be3cd23e5?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI3OTQ0YWUyMDQ4ZmIwMGYxNjE5ZGM4M2JlM2NkMjNlNSJ9.Ya42eQNOprV5vTCH_b7Q1R6BI_SiFykBa3fC2RBD1fk&download=image.png "")

![](https://tcs.teambition.net/storage/31221bfa69dd9ec663a27d3092c6524ef0c6?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIxYmZhNjlkZDllYzY2M2EyN2QzMDkyYzY1MjRlZjBjNiJ9.mV9Y06PmEjfK_Uwc9zMho6LAEHLEloIbV83yJTzwNq8&download=image.png "")

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <parent>
        <artifactId>spring-cloud-demo</artifactId>
        <groupId>com.imooc</groupId>
        <version>1.0-SNAPSHOT</version>
        <relativePath>../../pom.xml</relativePath>
    </parent>
    <modelVersion>4.0.0</modelVersion>

    <artifactId>sleuth-traceB</artifactId>

    <dependencies>
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-sleuth</artifactId>
        </dependency>

    </dependencies>

</project>
```

![](https://tcs.teambition.net/storage/31225c4dd6b535e242c8b65b028e8e03a35b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI1YzRkZDZiNTM1ZTI0MmM4YjY1YjAyOGU4ZTAzYTM1YiJ9.NF0n_97Ck7LzWoZt5phMdFzhBreJmAA-ZisAKlb0LsA&download=image.png "")

```java
package com.imooc.springcloud;

import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.WebApplicationType;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;
import org.springframework.cloud.client.loadbalancer.LoadBalanced;
import org.springframework.context.annotation.Bean;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;


@EnableDiscoveryClient
@SpringBootApplication
@RestController
@Slf4j
public class SleuthTraceBMain {

    @LoadBalanced
    @Bean
    public RestTemplate lb() {
        return new RestTemplate();
    }

    @Autowired
    private RestTemplate restTemplate;


    @GetMapping(value = "/traceB")
    public String traceB() {
        log.info("-------Trace B");
        return "traceB";
    }


    public static void main(String[] args) {
        new SpringApplicationBuilder(SleuthTraceBMain.class)
                .web(WebApplicationType.SERVLET)
                .run(args);
    }

}

```

![](https://tcs.teambition.net/storage/31226d6d61429a4acc223e0287dc6c6182d7?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI2ZDZkNjE0MjlhNGFjYzIyM2UwMjg3ZGM2YzYxODJkNyJ9.gUgM1VX4leG-AUNmOL6mBsPMJVrjjF1r9mD_FAbyKTw&download=image.png "")

```text
spring.application.name=sleuth-traceB
server.port=62001

eureka.client.serviceUrl.defaultZone=http://localhost:20000/eureka/

logging.file=${spring.application.name}.log


info.app.name=sleuth-traceB
info.app.description=test

spring.sleuth.sampler.probability=1

management.security.enabled.user.name=gitee
management.security.enabled.user.password=gitee
management.security.enabled.user.roles=ADMIN

management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always




```

![](https://tcs.teambition.net/storage/312246833fa658e9a2c7521934dc294ec681?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI0NjgzM2ZhNjU4ZTlhMmM3NTIxOTM0ZGMyOTRlYzY4MSJ9.KWlEdAIcXI4OI9qqAlJTrl9rcyEG56RftHkwnAm4F3w&download=image.png "")

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!--该日志将日志级别不同的log信息保存到不同的文件中 -->
<configuration>
    <include resource="org/springframework/boot/logging/logback/defaults.xml" />

    <springProperty scope="context" name="springAppName"
                    source="spring.application.name" />

    <!-- 日志输出位置 -->
    <property name="LOG_FILE" value="${BUILD_FOLDER:-build}/${springAppName}" />

    <!-- 日志格式 -->
    <property name="CONSOLE_LOG_PATTERN"
              value="%clr(%d{HH:mm:ss.SSS}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}" />

    <!-- 控制台输出 -->
    <appender name="console" class="ch.qos.logback.core.ConsoleAppender">
        <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
            <level>INFO</level>
        </filter>
        <!-- 日志输出编码 -->
        <encoder>
            <pattern>${CONSOLE_LOG_PATTERN}</pattern>
            <charset>utf8</charset>
        </encoder>
    </appender>



    <!-- 日志输出级别 -->
    <root level="INFO">
        <appender-ref ref="console" />
    </root>

</configuration>

```

启动

![](https://tcs.teambition.net/storage/31220aa5d0fd9b32edcfe123f86f47fab28a?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIwYWE1ZDBmZDliMzJlZGNmZTEyM2Y4NmY0N2ZhYjI4YSJ9.JiJ6apANpOcEMACtoCD_9RD2mic_ApebDVYLQ4ZlOzQ&download=image.png "")

![](https://tcs.teambition.net/storage/31223500045a792ab5eb2db720630b1f2625?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjIzNTAwMDQ1YTc5MmFiNWViMmRiNzIwNjMwYjFmMjYyNSJ9.J4l2oXKQcT8zFSZs6YWkmFDl_waOFI0MD6V3jTdYQ3E&download=image.png "")

![](https://tcs.teambition.net/storage/3122eaf9b5a5efd101c5be6f9d0ee8d2059d?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJlYWY5YjVhNWVmZDEwMWM1YmU2ZjlkMGVlOGQyMDU5ZCJ9.QJSqOe8SJ_fk2zg4vj-m8bB53lbL--V2Hp-lpl5XdYY&download=image.png "")

```text
23:23:16.560  INFO [-,c51f2524abf974c7,c51f2524abf974c7,false] 18444 --- [io-62001-exec-3] -------Trace B


```

![](https://tcs.teambition.net/storage/3122d4c929ed73eda9544b08ea6fd6c50dec?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJkNGM5MjllZDczZWRhOTU0NGIwOGVhNmZkNmM1MGRlYyJ9.Mx86JWuqYaZIgAegAtEsVeP9kukZEAtwAAGFnDo2sbY&download=image.png "")

![](https://tcs.teambition.net/storage/3122b69b0de39d8d31099abc317d6b30bc5b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjJiNjliMGRlMzlkOGQzMTA5OWFiYzMxN2Q2YjMwYmM1YiJ9.-lLenrmvhhTiN2xT7QK09MRP-paU6a6R7aycikxQCzE&download=image.png "")

```text
23:24:50.218  INFO [-,2f2648681c2cc772,2f2648681c2cc772,false] 18873 --- [io-62000-exec-2] -------Trace A
23:24:52.462  INFO [-,2f2648681c2cc772,f7110d6f95be2eaf,false] 18873 --- [io-62000-exec-2] Flipping property: sleuth-traceB.ribbon.ActiveConnectionsLimit to use NEXT property: niws.loadbalancer.availabilityFilteringRule.activeConnectionsLimit = 2147483647
23:24:52.646  INFO [-,2f2648681c2cc772,f7110d6f95be2eaf,false] 18873 --- [io-62000-exec-2] Shutdown hook installed for: NFLoadBalancer-PingTimer-sleuth-traceB
23:24:52.647  INFO [-,2f2648681c2cc772,f7110d6f95be2eaf,false] 18873 --- [io-62000-exec-2] Client: sleuth-traceB instantiated a LoadBalancer: DynamicServerListLoadBalancer:{NFLoadBalancer:name=sleuth-traceB,current list of Servers=[],Load balancer stats=Zone stats: {},Server stats: []}ServerList:null
23:24:52.702  INFO [-,2f2648681c2cc772,f7110d6f95be2eaf,false] 18873 --- [io-62000-exec-2] Using serverListUpdater PollingServerListUpdater
23:24:52.798  INFO [-,2f2648681c2cc772,f7110d6f95be2eaf,false] 18873 --- [io-62000-exec-2] Flipping property: sleuth-traceB.ribbon.ActiveConnectionsLimit to use NEXT property: niws.loadbalancer.availabilityFilteringRule.activeConnectionsLimit = 2147483647
23:24:52.808  INFO [-,2f2648681c2cc772,f7110d6f95be2eaf,false] 18873 --- [io-62000-exec-2] DynamicServerListLoadBalancer for client sleuth-traceB initialized: DynamicServerListLoadBalancer:{NFLoadBalancer:name=sleuth-traceB,current list of Servers=[192.168.4.100:62001],Load balancer stats=Zone stats: {defaultzone=[Zone:defaultzone;	Instance count:1;	Active connections count: 0;	Circuit breaker tripped count: 0;	Active connections per server: 0.0;]
},Server stats: [[Server:192.168.4.100:62001;	Zone:defaultZone;	Total Requests:0;	Successive connection failure:0;	Total blackout seconds:0;	Last connection made:Thu Jan 01 08:00:00 CST 1970;	First connection made: Thu Jan 01 08:00:00 CST 1970;	Active Connections:0;	total failure count in last (1000) msecs:0;	average resp time:0.0;	90 percentile resp time:0.0;	95 percentile resp time:0.0;	min resp time:0.0;	max resp time:0.0;	stddev resp time:0.0]
]}ServerList:org.springframework.cloud.netflix.ribbon.eureka.DomainExtractingServerList@310a86d2
23:24:53.716  INFO [-,,,] 18873 --- [erListUpdater-0] Flipping property: sleuth-traceB.ribbon.ActiveConnectionsLimit to use NEXT property: niws.loadbalancer.availabilityFilteringRule.activeConnectionsLimit = 2147483647


```

![](https://tcs.teambition.net/storage/312250c89e9536f617b6c84d0e1fa89e0778?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjI1MGM4OWU5NTM2ZjYxN2I2Yzg0ZDBlMWZhODllMDc3OCJ9.5kWaSJnr967Nra5eRtLlPcFEPr5MAyK1ohO8oFutM0Y&download=image.png "")

```text


23:23:16.560  INFO [-,c51f2524abf974c7,c51f2524abf974c7,false] 18444 --- [io-62001-exec-3] -------Trace B
					  trace Id          span trance Id  采样 如果是true 说明被采样了
23:24:53.126  INFO [-,2f2648681c2cc772,f7110d6f95be2eaf,false] 18444 --- [io-62001-exec-5] -------Trace B
23:25:53.731  INFO [-,,,] 18444 --- [trap-executor-0] Resolving eureka endpoints via configuration


```



开源笔记

可 Pull Requests 协作写开源笔记

如果笔记图片无法访问 请访问 [teambition](https://tburl.in/0jDNvpbK) 原版开源笔记

gitee

[https://gitee.com/opendevel/java-for-linux](https://gitee.com/opendevel/java-for-linux)

github

[https://github.com/OSrcD/java-for-linux](https://github.com/OSrcD/java-for-linux)

teambition

[https://tburl.in/0jDNvpbK](https://tburl.in/0jDNvpbK)

开源视频

bilibili

[https://space.bilibili.com/77266754](https://space.bilibili.com/77266754)

开源博客

oschina

[https://my.oschina.net/u/4675154](https://my.oschina.net/u/4675154)

csdn

[https://blog.csdn.net/OpenDevel](https://blog.csdn.net/OpenDevel)

开源项目

gitee

[https://gitee.com/opendevel](https://gitee.com/opendevel)

github

[https://github.com/OSrcD](https://github.com/OSrcD)

开源赞赏

![](https://tcs.teambition.net/storage/3121aed56e96d914e1046f3b498b493ce232?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjc5NTI3NiwiaWF0IjoxNjEyMTkwNDc2LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFhZWQ1NmU5NmQ5MTRlMTA0NmYzYjQ5OGI0OTNjZTIzMiJ9.PEVAfVp4OsdkKl95L3JZqcal0AySzdNlyxK1jFE7Cs0&download=image.png "")

