

![](https://tcs.teambition.net/storage/3121d8c56c841f4b5c595351c6cf970e0841?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFkOGM1NmM4NDFmNGI1YzU5NTM1MWM2Y2Y5NzBlMDg0MSJ9.OD-3KPHI2MIAZilEXW70fjPX2msov9F8XhsXm-94SH0&download=2020-09-17%20060610.png "")

![](https://tcs.teambition.net/storage/3121b266e11baf8893df2e31f02f9a6be4e1?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFiMjY2ZTExYmFmODg5M2RmMmUzMWYwMmY5YTZiZTRlMSJ9.cSSEKbwOs4Jj5mjca_F9ArgmklkcW0HVJ5rSKCYYik4&download=image.png "")

![](https://tcs.teambition.net/storage/3121b86a8ed8a3f0fa40dc174145822bf2bc?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFiODZhOGVkOGEzZjBmYTQwZGMxNzQxNDU4MjJiZjJiYyJ9.PgjaJpw6sFDPpPcwxg4duKrhxAJT5JNaJUg4-pPr9J8&download=image.png "")

![](https://tcs.teambition.net/storage/31211b463fc08e91755bf95704520fe65c3f?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjExYjQ2M2ZjMDhlOTE3NTViZjk1NzA0NTIwZmU2NWMzZiJ9.F82PBSc8bq1HVRPfruHKDf5nmlXzMbFtmB5GX37l8-s&download=image.png "")

![](https://tcs.teambition.net/storage/31213e37ea8d6e52767eae1d6ff72043a37a?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjEzZTM3ZWE4ZDZlNTI3NjdlYWUxZDZmZjcyMDQzYTM3YSJ9.MJxJtxCdcJDdGVQyiJgpIib7SmsRLPXx3u7hpboMy_g&download=2020-09-17%20060631.png "")

![](https://tcs.teambition.net/storage/31215dfab1c02c30a52a2468432f7c0a723b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE1ZGZhYjFjMDJjMzBhNTJhMjQ2ODQzMmY3YzBhNzIzYiJ9.CV6uHMGmdsJ4RD5wL1qo77W7hQM5fnh4kzVE0C7oFIY&download=image.png "")

![](https://tcs.teambition.net/storage/3121441d395de21f8ff0c7b153d552577e2c?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE0NDFkMzk1ZGUyMWY4ZmYwYzdiMTUzZDU1MjU3N2UyYyJ9.npEeYNNBygtsOVi4aDFm8YhwVHmCSRRNEnpPwbUfZqw&download=image.png "")

![](https://tcs.teambition.net/storage/3121031b83afc1a233c63cfbb9ea017f55a7?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjEwMzFiODNhZmMxYTIzM2M2M2NmYmI5ZWEwMTdmNTVhNyJ9.Y9jNO5XimzRUH-KCu2z9AFYZp5gg52WKOeXd1ERlB6I&download=image.png "")

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <parent>
        <artifactId>spring-cloud-demo</artifactId>
        <groupId>com.imooc</groupId>
        <version>1.0-SNAPSHOT</version>
        <relativePath>../../pom.xml</relativePath>
    </parent>
    <modelVersion>4.0.0</modelVersion>

    <packaging>jar</packaging>

    <artifactId>gateway-sample</artifactId>

    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-gateway</artifactId>
        </dependency>


        <!-- Spring boot 下面的 Redis 插件 就可以在配置文件 配置 Redis 连接串 -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-redis-reactive</artifactId>
        </dependency>


    </dependencies>




</project>
```

![](https://tcs.teambition.net/storage/31216c6c6b9cdb2aebb8ae5b45fe7f72be56?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE2YzZjNmI5Y2RiMmFlYmI4YWU1YjQ1ZmU3ZjcyYmU1NiJ9.hOOqHcUeNi1pBa8HUFo_NNv_k1EuLmkynNU9PgM5aaM&download=image.png "")

```java
package com.imooc.springcloud;


import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;

// 基于 Eureka 服务发现 创建自动的路由规则
@EnableDiscoveryClient
@SpringBootApplication
public class GatewayApplication {

    public static void main(String[] args) {
        SpringApplication.run(GatewayApplication.class, args);
    }

}


```

![](https://tcs.teambition.net/storage/312171569d0ee41ecd109b2dac022858b8cf?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE3MTU2OWQwZWU0MWVjZDEwOWIyZGFjMDIyODU4YjhjZiJ9.jWhBHm4FxZ1Aj5BGZorHLbG_VnqBeof8MJn8lqdiyGU&download=image.png "")

```yaml
spring:
  application:
    name: gateway-service
  cloud:
    gateway:
      # 利用服务发现机制 自动创建路由规则 跟 Eureka 相关
      discovery:
        # 定位器 通过 discovery 的服务发现 把你的服务 在 Eureka 注册中心
        # 注册好的 所有服务 统统的给它定位到 怎么定位好的 gateway 的问题
        locator:
          # 自动创建服务路由开关给它打开
          enabled: true
          # 小写 路由寻址 调用服务 大写失效
          lower-case-service-id: true




server:
  port: 65000

eureka:
  client:
    serviceUrl:
      defaultZone: http://localhost:20000/eureka/

management:
  security:
    user:
      name: gitee
      password: gitee
      roles: ADMIN
  endpoints:
    web:
      exposure:
        include: "*"
  endpoint:
    health:
      show-details: always

```

启动

![](https://tcs.teambition.net/storage/31210c4ab6b951ce2b12c2abc63405ece85a?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjEwYzRhYjZiOTUxY2UyYjEyYzJhYmM2MzQwNWVjZTg1YSJ9.9rcLY29geDOKme3Tgc6a7s___hU9aI6LLmjtlQ5eLno&download=image.png "")

![](https://tcs.teambition.net/storage/31219b155ba2bbb4ea6bb984afc19ecfce31?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE5YjE1NWJhMmJiYjRlYTZiYjk4NGFmYzE5ZWNmY2UzMSJ9.33XdEuxGPwL9LkUb2I75VG9yGbeIHuxrzz8CmRMfukM&download=image.png "")

![](https://tcs.teambition.net/storage/312142319aa557a2b14a68816662946e7b81?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE0MjMxOWFhNTU3YTJiMTRhNjg4MTY2NjI5NDZlN2I4MSJ9.nvh_oP2lAV-7oBD_PSAtB3Agb40uz182lVib1s-bGXE&download=image.png "")

![](https://tcs.teambition.net/storage/31215ac027eacde98dea4b54947838a4cd2d?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE1YWMwMjdlYWNkZTk4ZGVhNGI1NDk0NzgzOGE0Y2QyZCJ9.3S2LB5CFigs4C9F9bSqvwjTQD-NyFxaun2tbI5SBHH0&download=image.png "")

![](https://tcs.teambition.net/storage/31218dbdf10e97a15045f3ba5f567729ea78?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE4ZGJkZjEwZTk3YTE1MDQ1ZjNiYTVmNTY3NzI5ZWE3OCJ9.KpQ2wfjIK-LZ3aII92zgoiYjsh1fM9Extz-KbEUxZGc&download=image.png "")

![](https://tcs.teambition.net/storage/3121365a101651ddb35ea0fb5dd1f201372e?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjEzNjVhMTAxNjUxZGRiMzVlYTBmYjVkZDFmMjAxMzcyZSJ9.DsfFs9boKAQeU93kLdTB_MQfmSePA6bjYx8kq-kDG7Y&download=image.png "")

![](https://tcs.teambition.net/storage/31217357c7b2fdf0e25b25f5cce417871b0f?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE3MzU3YzdiMmZkZjBlMjViMjVmNWNjZTQxNzg3MWIwZiJ9.EhZijg1Twy2tA_voX7KULbPms7Qwem2c8ZE6f4sKSIo&download=image.png "")

![](https://tcs.teambition.net/storage/31215fb9a6ee78e388eaf366a79651f70e8d?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE1ZmI5YTZlZTc4ZTM4OGVhZjM2NmE3OTY1MWY3MGU4ZCJ9.H_gX8mUNIA242PKqmFBhjY4wyC8KiZkN7guN3Bab8V4&download=image.png "")

![](https://tcs.teambition.net/storage/3121d2cc18db653b322968df2d85dc95e41b?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFkMmNjMThkYjY1M2IzMjI5NjhkZjJkODVkYzk1ZTQxYiJ9.Xwb_njL4H8J_ULxTmVmNkCFwQy2JDCHaQqsdzSV6OsQ&download=image.png "")

查看都注册了那些路由规则

![](https://tcs.teambition.net/storage/31217d94ac211b8ce2cdd3ea7377b0264b87?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE3ZDk0YWMyMTFiOGNlMmNkZDNlYTczNzdiMDI2NGI4NyJ9.z9dZebcQ0EHJfPO48-38AbGSCeR8MdcWdAiOaczy-tY&download=image.png "")

```json
/**
* 这里的元素 是和 eureka 注册中心已经注册上的服务的 服务名称 一一对应的
* 你有几个服务 我的 gateway 就  会自动创建路由规则 创建的路由规则有两部分
* 一个是断言 一个是过滤器
**/

[
  {
    route_id: "CompositeDiscoveryClient_FEIGN-CLIENT",
    route_definition: {
      id: "CompositeDiscoveryClient_FEIGN-CLIENT",
      predicates: [
        {
          name: "Path",
          args: {
            pattern: "/FEIGN-CLIENT/**"
          }
        }
      ],
      filters: [
        {
          name: "RewritePath",
          args: {
            regexp: "/FEIGN-CLIENT/(?<remaining>.*)",
            replacement: "/${remaining}"
          }
        }
      ],
	  
	  /**
	  * 在Eureka 注册上来的 Application
      * lb 是当 我们访问请求 抵达 gateway 的时候 会替我们做负载均衡 默认是轮询
	  * 会通过负载均衡进行转发 转发 规则 它的路由规则 就是 匹配你路径中的第一个位置
      * http://localhost:65000/FEIGN-CLIENT/sayHi
	  * 也就是 我们当前 FEIGN-CLIENT 所以处的位置 如果这个位置给出的路径 它可以
      * 匹配上 任何 一个已经在eureka服务中心注册上的 Application 哪 gateway 就会
      * 把当前的用户请求 转发到 对应的 server里面 
	  **/

      uri: "lb://FEIGN-CLIENT",
      order: 0
    },
    order: 0
  },
  {
    route_id: "CompositeDiscoveryClient_GATEWAY-SERVICE",
    route_definition: {
      id: "CompositeDiscoveryClient_GATEWAY-SERVICE",
      predicates: [
        {
          name: "Path",
          args: {
            pattern: "/GATEWAY-SERVICE/**"
          }
        }
      ],
      filters: [
        {
          name: "RewritePath",
          args: {
            regexp: "/GATEWAY-SERVICE/(?<remaining>.*)",
            replacement: "/${remaining}"
          }
        }
      ],
	  /**
	  * GATEWAY-SERVICE 是注册中心的名字 
	  **/
      uri: "lb://GATEWAY-SERVICE",
      order: 0
    },
    order: 0
  }
]
```

![](https://tcs.teambition.net/storage/31218faf1f1950bbba74c6adf9c61e7650f7?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE4ZmFmMWYxOTUwYmJiYTc0YzZhZGY5YzYxZTc2NTBmNyJ9.KB6mPnCATR6Kr56nflA5ytKz5VLwzt4hS3Y6lAS_e3E&download=image.png "")

![](https://tcs.teambition.net/storage/312199d7a1bdee558b492e9f9afdbb56a006?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE5OWQ3YTFiZGVlNTU4YjQ5MmU5ZjlhZmRiYjU2YTAwNiJ9.Xaas22kSPwzPBMBADxsxBxfvQDNWIoIMtdkhOdwNCO0&download=image.png "")

![](https://tcs.teambition.net/storage/3121a41ca92f049eed7800e04dfef7c027f6?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFhNDFjYTkyZjA0OWVlZDc4MDBlMDRkZmVmN2MwMjdmNiJ9.lSKaOSoFf_mOVsqnj4hU937ZWYbN94v4jBu5Vsn02z8&download=image.png "")

![](https://tcs.teambition.net/storage/3121fe94967b8e2ac82a999fd83c8cd4ebb3?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFmZTk0OTY3YjhlMmFjODJhOTk5ZmQ4M2M4Y2Q0ZWJiMyJ9.zyBVByW3xWYQ1qcYolSyU5fqA74NT_FeyCr6j7Bc9Uw&download=image.png "")

重新启动

![](https://tcs.teambition.net/storage/3121265f98896bf62a16b24f605b60cc00cf?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjEyNjVmOTg4OTZiZjYyYTE2YjI0ZjYwNWI2MGNjMDBjZiJ9.uZ24S6WBJnSPGNF3N-CSA41ZIHGj56X98lqJjdn9umw&download=image.png "")

![](https://tcs.teambition.net/storage/312157c1fab7951d5d8f6da369b054a7654d?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE1N2MxZmFiNzk1MWQ1ZDhmNmRhMzY5YjA1NGE3NjU0ZCJ9.TVgiqfDli8lpTleUORmTuLcGAe_PdkiZukH6x9WSr9k&download=image.png "")

![](https://tcs.teambition.net/storage/312169ef008d4d3e87bfb69b2fb09f972e72?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE2OWVmMDA4ZDRkM2U4N2JmYjY5YjJmYjA5Zjk3MmU3MiJ9.QKlWPchGQZKvjg_PcBCgAF1fAXF50fjc5kbnrRmB1nE&download=image.png "")



添加路由规则的唯一ID 

![](https://tcs.teambition.net/storage/3121c0884850dcba154974b25b2f54eff8d6?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFjMDg4NDg1MGRjYmExNTQ5NzRiMjViMmY1NGVmZjhkNiJ9.FfXi82KwCnKa3k_dzDvfpIOalGOcOAyA95Ts1496k3A&download=image.png "")

[http://localhost:65000/actuator/gateway/routes/dynamic](http://localhost:65000/actuator/gateway/routes/dynamic)

```json
{
  /**
   * predicates 是匹配 你的 访问 路径的 
  **/
  "predicates": [
    {
      "name": "Path",
      "args": {
        "_genkey_0": "/dynamic/**"
      }
    }
  ],
  /**
   * filters 是对你的访问路径 或者 是你 参数 等等 最一些过滤 和处理 
  **/
  "filters": [
    {
      "name": "StripPrefix",
      "args": {
        "_genkey_0": "1"
      }
    }
  ],
  // 当你的路由规则被匹配了以后 它将转发到 eureka中的 Feign client 服务 同时
  // lb 利用负载均衡策略 
  "uri": "lb://FEIGN-CLIENT",
  // 生效的顺位	
  "order": 0
}
```

![](https://tcs.teambition.net/storage/31215b5bb6ead81cb21dbf54e8122185f8f5?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE1YjViYjZlYWQ4MWNiMjFkYmY1NGU4MTIyMTg1ZjhmNSJ9.9dhW0yFvx8M7aFsVH6R-NVaBWbLCyriWYSQXQMqxWJ8&download=image.png "")

![](https://tcs.teambition.net/storage/31210266cb0613c0528497e33a70503a6316?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjEwMjY2Y2IwNjEzYzA1Mjg0OTdlMzNhNzA1MDNhNjMxNiJ9.HLClIcmWppLvSgBt-IgK4rHjIACN1WEKJTPQCJbJV-0&download=image.png "")

```json
{
  "predicates": [
    {
      "name": "Path",
      "args": {
        "_genkey_0": "/dynamic/**"
      }
    }
  ],
  "filters": [
    {
      "name": "StripPrefix",
      "args": {
        "_genkey_0": "1"
      }
    }
  ],
  "uri": "lb://FEIGN-CLIENT",
  "order": 0
}
```

![](https://tcs.teambition.net/storage/312147d79bfc28096406cc1c4239aafa6cde?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE0N2Q3OWJmYzI4MDk2NDA2Y2MxYzQyMzlhYWZhNmNkZSJ9.xqObFDJ7xOAB38tLk9bNOwLAYKJLftjiAnzWTK_pxD4&download=image.png "")

```json
[
  {
    "route_id": "CompositeDiscoveryClient_FEIGN-CLIENT",
    "route_definition": {
      "id": "CompositeDiscoveryClient_FEIGN-CLIENT",
      "predicates": [
        {
          "name": "Path",
          "args": {
            "pattern": "/feign-client/**"
          }
        }
      ],
      "filters": [
        {
          "name": "RewritePath",
          "args": {
            "regexp": "/feign-client/(?<remaining>.*)",
            "replacement": "/${remaining}"
          }
        }
      ],
      "uri": "lb://FEIGN-CLIENT",
      "order": 0
    },
    "order": 0
  },
  {
    "route_id": "CompositeDiscoveryClient_GATEWAY-SERVICE",
    "route_definition": {
      "id": "CompositeDiscoveryClient_GATEWAY-SERVICE",
      "predicates": [
        {
          "name": "Path",
          "args": {
            "pattern": "/gateway-service/**"
          }
        }
      ],
      "filters": [
        {
          "name": "RewritePath",
          "args": {
            "regexp": "/gateway-service/(?<remaining>.*)",
            "replacement": "/${remaining}"
          }
        }
      ],
      "uri": "lb://GATEWAY-SERVICE",
      "order": 0
    },
    "order": 0
  },
  // 添加的路由规则
  {
    "route_id": "dynamic",
    "route_definition": {
      "id": "dynamic",
      "predicates": [
        {
          "name": "Path",
          "args": {
            "_genkey_0": "/dynamic/**"
          }
        }
      ],
      "filters": [
        {
          "name": "StripPrefix",
          "args": {
            "_genkey_0": "1"
          }
        }
      ],
      "uri": "lb://FEIGN-CLIENT",
      "order": 0
    },
    "order": 0
  }
]
```

地址匹配的断言  当你的访问请求 后面是 以 dynamic开头 统统都会匹配上 都会匹配上这个路由规则 lb://FEIGN-CLIENT

![](https://tcs.teambition.net/storage/3121e87a44958a5bed6a3886896126775d9f?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFlODdhNDQ5NThhNWJlZDZhMzg4Njg5NjEyNjc3NWQ5ZiJ9.HB0Z7LQS6rugo5skpt7qVIra-mZuwapbpG6V8yHQANc&download=image.png "")

删除路由

![](https://tcs.teambition.net/storage/312182b6658e98fa367eb269ff2b6d3cc8af?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjE4MmI2NjU4ZTk4ZmEzNjdlYjI2OWZmMmI2ZDNjYzhhZiJ9.CxBI3HzvZMptpVekyQD4DozvpszsahdY7Dat59WTMwo&download=image.png "")



开源笔记

可 Pull Requests 协作写开源笔记

如果笔记图片无法访问 请访问 [teambition](https://tburl.in/0jDNvpbK) 原版开源笔记

gitee

[https://gitee.com/opendevel/java-for-linux](https://gitee.com/opendevel/java-for-linux)

github

[https://github.com/OSrcD/java-for-linux](https://github.com/OSrcD/java-for-linux)

teambition

[https://tburl.in/0jDNvpbK](https://tburl.in/0jDNvpbK)

开源视频

bilibili

[https://space.bilibili.com/77266754](https://space.bilibili.com/77266754)

开源博客

oschina

[https://my.oschina.net/u/4675154](https://my.oschina.net/u/4675154)

csdn

[https://blog.csdn.net/OpenDevel](https://blog.csdn.net/OpenDevel)

开源项目

gitee

[https://gitee.com/opendevel](https://gitee.com/opendevel)

github

[https://github.com/OSrcD](https://github.com/OSrcD)

开源赞赏

![](https://tcs.teambition.net/storage/3121aed56e96d914e1046f3b498b493ce232?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxMjQ0ODU5MCwiaWF0IjoxNjExODQzNzkwLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMjFhZWQ1NmU5NmQ5MTRlMTA0NmYzYjQ5OGI0OTNjZTIzMiJ9._SFH6EXjYT0QB7NeVKNd7vSEIZMkczcCjJcyGPKjj7Q&download=image.png "")

